
- name: Enable firewalld
  become: yes
  become_method: sudo
  become_user: root
  service:
    name: firewalld
    enabled: yes
    state: started

- name: Opening port for rabbitmq management
  become: yes
  become_method: sudo
  become_user: root
  command: firewall-cmd --add-port={{ item }}/tcp --permanent
  with_items:
    - "{{ rmq_port.management_port }}"
    - "{{ rmq_port.server_port }}"
    - "{{ rmq_port.cluster_port1 }}"
    - "{{ rmq_port.cluster_port2 }}"

- name: Reload firewalld
  command: firewall-cmd --reload
